#include <stdio.h>
#include <stdlib.h>
#include <string.h>



char* code(char* str, int len){
    
    char * toHardcode = calloc(len,sizeof(char));
    strcpy(toHardcode,str);
    printf("Debug: %s\n",toHardcode);

    for(int i = 1 ; i < len ; i++){
        for(int j = len - 1 ; j >= i ; j--){
            //printf("i = %d ; j = %d \n",i,j);
            //printf("%c, %d ^ %d\n",toHardcode[j],toHardcode[j-1],toHardcode[j]);
            toHardcode[j] = toHardcode[j-1] ^ toHardcode[j];
            //printf("obtenu %d \n",toHardcode[j]);
        }
    } 

    // for(int k= 0 ; k < len ; k ++){
    //     printf("Debug %d: %d\n",k,toHardcode[k]);
    // }

    return toHardcode;
}


char* decode(char* coded, int len){

    char* decoded = calloc(len,sizeof(char));
    strcpy(decoded,coded);

    for(int i= len - 1 ; i > 0 ; i--){
        for(int j = i ; j < len ; j++){
            decoded[j] = decoded[j-1] ^ decoded[j];
        }  
    }

    // for(int k= 0 ; k < len ; k ++){
    //     printf("Debug %d: %d\n",k,decoded[k]);
    // }

    return decoded;
}


int main(int argc, char const *argv[])
{

    if(argc > 1){
        char* str = argv[1];
        int len = strlen(str);
        printf("len: %d\n",len);

        // for(int k= 0 ; k < len ; k ++){
        //     printf("Debug %d: %d\n",k,str[k]);
        // }
        char* coded = code(str,len);
        printf("Coded: %s",coded);
        printf("\n");
        char* decoded = decode(coded,len);
        printf("Decoded: %s",decoded);
        printf("\n");
        printf("%d",strcmp(str,decoded));
    }
    else{
        printf("Put a fucking argument\n");
        return EXIT_FAILURE;
    }
    
    return EXIT_SUCCESS;
}
